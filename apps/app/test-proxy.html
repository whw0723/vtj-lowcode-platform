<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•ä»£ç†é…ç½®</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
    </style>
</head>
<body>
    <h1>æµ‹è¯•VTJä»£ç†é…ç½®</h1>
    <button onclick="testProxy()">æµ‹è¯•ä»£ç†</button>
    <button onclick="testDirect()">æµ‹è¯•ç›´è¿</button>
    <div id="result"></div>

    <script>
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            document.getElementById('result').appendChild(div);
        }

        async function testProxy() {
            log('ğŸ”„ æµ‹è¯•é€šè¿‡ä»£ç†è®¿é—®ç‰©æµæ¥å£...', 'info');
            
            try {
                const params = new URLSearchParams();
                params.append('page', '1');
                params.append('limit', '5');
                params.append('hospital', '0');
                params.append('logisticsselect', '');
                params.append('searchcontent', '');
                params.append('logisticsptype', '');
                params.append('quertime', '');
                params.append('logistictime', '');
                params.append('decmothed', '-1');

                const response = await axios.post('/Manage/Logistics/GetLogisticsToday', params, {
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
                        'Accept': 'application/json, text/javascript, */*; q=0.01',
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });

                log(`âœ… ä»£ç†æµ‹è¯•æˆåŠŸï¼çŠ¶æ€: ${response.status}`, 'success');
                log(`ğŸ“Š å“åº”æ•°æ®: ${JSON.stringify(response.data, null, 2)}`, 'info');
                
            } catch (error) {
                log(`âŒ ä»£ç†æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                log(`ğŸ” é”™è¯¯è¯¦æƒ…: ${error.response?.status} - ${error.response?.statusText}`, 'error');
                if (error.response?.data) {
                    log(`ğŸ“„ é”™è¯¯å“åº”: ${typeof error.response.data === 'string' ? error.response.data.substring(0, 200) + '...' : JSON.stringify(error.response.data)}`, 'error');
                }
            }
        }

        async function testDirect() {
            log('ğŸ”„ æµ‹è¯•ç›´æ¥è®¿é—®åç«¯æœåŠ¡å™¨...', 'info');
            
            try {
                const params = new URLSearchParams();
                params.append('page', '1');
                params.append('limit', '5');
                params.append('hospital', '0');
                params.append('logisticsselect', '');
                params.append('searchcontent', '');
                params.append('logisticsptype', '');
                params.append('quertime', '');
                params.append('logistictime', '');
                params.append('decmothed', '-1');

                const response = await axios.post('http://192.168.80.79:8000/Manage/Logistics/GetLogisticsToday', params, {
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
                        'Accept': 'application/json, text/javascript, */*; q=0.01',
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    mode: 'cors'
                });

                log(`âœ… ç›´è¿æµ‹è¯•æˆåŠŸï¼çŠ¶æ€: ${response.status}`, 'success');
                log(`ğŸ“Š å“åº”æ•°æ®: ${JSON.stringify(response.data, null, 2)}`, 'info');
                
            } catch (error) {
                log(`âŒ ç›´è¿æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                log(`ğŸ” é”™è¯¯è¯¦æƒ…: ${error.response?.status} - ${error.response?.statusText}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºè¯´æ˜
        window.onload = function() {
            log('ğŸ“‹ ä»£ç†æµ‹è¯•å·¥å…·å·²å°±ç»ª', 'info');
            log('ğŸ”— ä»£ç†é…ç½®: /Manage -> http://192.168.80.79:8000', 'info');
            log('ğŸ’¡ ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•', 'info');
        };
    </script>
</body>
</html>
